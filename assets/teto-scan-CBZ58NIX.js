import"./styles-CQEqC4-o.js";import{e as y}from"./score-B4IAOyqW.js";import"./types-CWP0aW2C.js";const l=document.querySelector("#upload"),s=document.querySelector("#preview"),d=document.querySelector("#analyze"),i=document.querySelector("#status"),u=s.getContext("2d",{willReadFrequently:!0});let h=!1;function p(t){const e=Math.min(t.width,t.height),o=(t.width-e)/2,n=(t.height-e)/2;u.clearRect(0,0,s.width,s.height),u.drawImage(t,o,n,e,e,0,0,s.width,s.height)}l.onchange=()=>{const t=l.files?.[0];if(!t)return;const e=URL.createObjectURL(t),o=new Image;o.onload=()=>{p(o),h=!0,i.textContent="사진 업로드 완료",URL.revokeObjectURL(e)},o.src=e};function c(t,e,o){return Math.max(e,Math.min(o,t))}function x(t){const e=c(t[2],0,1),o=c(t[4],0,1),n=c(t[5],0,1),r=c(Math.abs(t[1]),0,1),g=c(t[0],0,1),m=.45*n+.35*e+.2*r,w=.45*o+.25*g+.3*(1-n);let a=50+(m-w)*38;const f=.55+.45*c(e*1.7+n*.8,0,1);return a=50+(a-50)*f,a=c(Math.round(a),15,85),{teto:a,egen:100-a}}d.onclick=async()=>{if(!h){i.textContent="먼저 사진을 업로드해 주세요.";return}d.disabled=!0,i.textContent="테토/에겐 무드 계산 중...";const t=document.createElement("canvas");t.width=224,t.height=224,t.getContext("2d").drawImage(s,0,0,224,224);const e=t.getContext("2d").getImageData(0,0,224,224),o=y(e),{teto:n,egen:r}=x(o);sessionStorage.setItem("teto_result",JSON.stringify({teto:n,egen:r})),sessionStorage.setItem("teto_face",s.toDataURL("image/jpeg",.9)),window.location.href="/teto-result.html"};
