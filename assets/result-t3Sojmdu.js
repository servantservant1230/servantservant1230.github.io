import"./styles-Cm1FHhnm.js";import{i as C}from"./ads-D-IuExRI.js";import{N as T}from"./types-CWP0aW2C.js";const g=document.querySelector("#result"),w=document.querySelector("#share-image"),u=document.querySelector("#share-link"),b=sessionStorage.getItem("nsolo_result");let d=sessionStorage.getItem("nsolo_face");const M=new URLSearchParams(location.search),y=M.get("lang")||"ko",x={ko:{title:"나는 솔로에 나간다면 나의 이름은?",subtitle:"Top 3 이름 결과를 확인해보세요.",retry:"다시 분석",empty:"결과가 없습니다. 다시 분석해주세요.",uncertain:"유사한 타입이 겹쳐 보여요. 더 정면/근거리 얼굴 사진으로 다시 시도해보세요.",confidenceHigh:"매칭 신뢰도 높음",confidenceMid:"매칭 신뢰도 보통",confidenceLow:"매칭 신뢰도 낮음",retryGuide:"정면/밝은 조명/단독 얼굴로 다시 촬영하면 정확도가 올라갑니다.",topHint:"인상 키워드 기반으로 가장 가까운 타입입니다."},en:{title:"If you joined I AM SOLO, what would your name be?",subtitle:"Check your Top 3 name results.",retry:"Try Again",empty:"No result found. Please run analysis again.",uncertain:"The top matches are very close. Try again with a clearer front-face photo.",confidenceHigh:"Match confidence: High",confidenceMid:"Match confidence: Medium",confidenceLow:"Match confidence: Low",retryGuide:"Retry with a front-facing, well-lit, single-face photo for better accuracy.",topHint:"Closest type based on visual impression keywords."},ja:{title:"나는 솔로 に出たら、私の名前は？",subtitle:"Top 3 名前の結果を確認してください。",retry:"もう一度分析",empty:"結果がありません。もう一度分析してください。",uncertain:"上位候補が近すぎます。正面で鮮明な顔写真で再試行してください。",confidenceHigh:"マッチ信頼度: 高い",confidenceMid:"マッチ信頼度: 普通",confidenceLow:"マッチ信頼度: 低い",retryGuide:"正面・明るい環境・単独の顔写真で再試行すると精度が上がります。",topHint:"印象キーワードベースで最も近いタイプです。"}},s=x[y]||x.ko,S=document.querySelector(".hero h1"),v=document.querySelector(".hero p"),h=document.querySelector(".row .btn.ghost");S&&(S.textContent=s.title);v&&(v.textContent=s.subtitle);h&&(h.textContent=s.retry,h.href=`/scan.html?lang=${encodeURIComponent(y)}`);function $(a,t){const e={rows:a.map(r=>({slug:r.slug,p:r.p})),face:t||void 0};return btoa(unescape(encodeURIComponent(JSON.stringify(e))))}function L(a){if(!a)return null;try{return JSON.parse(decodeURIComponent(escape(atob(a))))}catch{return null}}async function k(a){if(!a)return null;const t=a;try{const e=await new Promise((n,c)=>{const o=new Image;o.onload=()=>n(o),o.onerror=c,o.src=t}),r=document.createElement("canvas");r.width=96,r.height=96;const f=r.getContext("2d");return f?(f.drawImage(e,0,0,96,96),r.toDataURL("image/jpeg",.72)):t}catch{return t}}async function P(a){const t=document.createElement("canvas");t.width=1080,t.height=1350;const e=t.getContext("2d"),r=e.createLinearGradient(0,0,1080,1350);r.addColorStop(0,"#101827"),r.addColorStop(.5,"#1e1b4b"),r.addColorStop(1,"#312e81"),e.fillStyle=r,e.fillRect(0,0,t.width,t.height),e.fillStyle="rgba(255,255,255,0.12)",e.beginPath(),e.arc(900,180,220,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(200,1160,280,0,Math.PI*2),e.fill(),e.fillStyle="#dbeafe",e.font="700 30px system-ui",e.fillText("AI FACE MATCH",80,84),e.fillStyle="#ffffff",e.font="800 64px system-ui",e.fillText("나의 나는솔로 이름은",80,156);const f=a[0];if(e.fillStyle="#a5b4fc",e.font="700 44px system-ui",e.fillText(`${f?.label??"-"} 타입`,80,214),d){const n=d;try{const c=await new Promise((o,i)=>{const m=new Image;m.onload=()=>o(m),m.onerror=i,m.src=n});e.save(),e.beginPath(),e.roundRect(80,250,920,520,36),e.clip(),e.drawImage(c,80,250,920,520),e.restore(),e.strokeStyle="rgba(255,255,255,0.6)",e.lineWidth=3,e.strokeRect(80,250,920,520)}catch{}}return a.forEach((n,c)=>{const o=860+c*140,i=Math.round(n.p*10)/10;e.fillStyle="#ffffff",e.font=c===0?"800 46px system-ui":"700 38px system-ui",e.fillText(`${c+1}. ${n.label}`,90,o),e.fillStyle="#c7d2fe",e.font="700 30px system-ui",e.fillText(`${i}%`,420,o),e.fillStyle="rgba(255,255,255,0.18)",e.fillRect(520,o-30,460,20),e.fillStyle=c===0?"#fbbf24":"#93c5fd",e.fillRect(520,o-30,Math.max(14,Math.min(460,i*4.6)),20),e.fillStyle="#dbeafe",e.font="500 24px system-ui",e.fillText(n.desc,90,o+38)}),e.fillStyle="rgba(255,255,255,0.72)",e.font="500 23px system-ui",e.fillText("오락용 아키타입 분류 · 실존 인물 식별 아님",80,1294),t}const p=L(M.get("r"));let l=null;if(b)l=JSON.parse(b);else if(p?.rows){const a=new Map(T.map(t=>[t.slug,t]));l=p.rows.map(t=>{const e=a.get(t.slug);return e?{...e,p:t.p}:null}).filter(Boolean)}p?.face&&!d&&(d=p.face);if(!l?.length)g.innerHTML=`<p>${s.empty}</p>`;else{const a=(l[0]?.p??0)-(l[1]?.p??0),t=a>=14?s.confidenceHigh:a>=8?s.confidenceMid:s.confidenceLow,e=a>=14?"confidence-high":a>=8?"confidence-mid":"confidence-low",r=a<8?`<div class="card"><p class="muted">${s.uncertain}</p><small class="muted">${s.retryGuide}</small></div>`:"",f=d?`<div class="card"><small class="muted">탐지된 얼굴</small><div style="margin-top:8px"><img src="${d}" alt="detected face" style="width:100%;max-width:220px;border-radius:16px;border:1px solid #dbe5f3;display:block"/></div></div>`:"";g.innerHTML=`<div class="card confidence-card ${e}"><strong>${t}</strong><br/><small class="muted">${s.topHint}</small></div>`+r+f+l.map((n,c)=>{const o=Number.isFinite(n.p)?n.p:0,i=Math.max(0,Math.min(100,Math.round(o*10)/10));return`
    <div class="card result-card ${c===0?"top-card":""}">
      <small class="muted">${c+1}순위</small>
      <div class="result-top">${n.label} <span class="muted" style="font-size:22px">${i}%</span></div>
      <p>${n.desc}</p>
      <div class="bar"><i style="width:${i}%"></i></div>
    </div>`}).join(""),w&&(w.onclick=async()=>{const n=await P(l),c=await new Promise(i=>n.toBlob(i,"image/png"));if(!c)return;const o=new File([c],"nsolo-result.png",{type:"image/png"});try{if(navigator.share&&navigator.canShare?.({files:[o]}))await navigator.share({files:[o],title:"나는솔로 테스트 결과"});else{const i=document.createElement("a");i.href=URL.createObjectURL(c),i.download="nsolo-result.png",document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(i.href)}}catch{}}),u&&(u.onclick=async()=>{const n=new URL(location.href),c=await k(d);n.searchParams.set("lang",y),n.searchParams.set("r",$(l,c));const o=`${n.origin}${n.pathname}?${n.searchParams.toString()}`;await navigator.clipboard.writeText(o),u.textContent="복사됨!",setTimeout(()=>{u&&(u.textContent="결과 링크 복사")},1200)})}C();
