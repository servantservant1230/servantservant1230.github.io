import"./styles-CQEqC4-o.js";import{i as G}from"./ads-D-IuExRI.js";import{N as _}from"./types-CWP0aW2C.js";const T=document.querySelector("#result"),p=document.querySelector("#share-social"),u=document.querySelector("#share-image"),h=document.querySelector("#share-link"),J=document.querySelector("#share-sheet"),b=document.querySelector("#share-kakao"),M=document.querySelector("#share-x"),P=document.querySelector("#share-telegram"),I=document.querySelector("#share-facebook"),R=document.querySelector("#share-instagram"),U=sessionStorage.getItem("nsolo_result");let m=sessionStorage.getItem("nsolo_face");const E=new URLSearchParams(location.search),C=E.get("lang")||"ko",O={ko:{title:"나는 솔로에 나간다면 나의 이름은?",subtitle:"Top 3 이름 결과를 확인해보세요.",retry:"다시 분석",empty:"결과가 없습니다. 다시 분석해주세요.",uncertain:"유사한 타입이 겹쳐 보여요. 더 정면/근거리 얼굴 사진으로 다시 시도해보세요.",confidenceHigh:"매칭 신뢰도 높음",confidenceMid:"매칭 신뢰도 보통",confidenceLow:"매칭 신뢰도 낮음",retryGuide:"정면/밝은 조명/단독 얼굴로 다시 촬영하면 정확도가 올라갑니다.",topHint:"인상 키워드 기반으로 가장 가까운 타입입니다.",shareSocial:"친구에게 공유하기",shareImage:"결과 이미지 저장",shareLink:"링크 복사",copied:"복사됨!",copiedDesc:"친구에게 링크를 붙여넣어 공유해보세요.",shareOpened:"공유창이 열렸어요",copyFallback:"복사가 막혀서 수동 복사창을 열었어요.",topPick:"오늘의 시그니처 타입",facePreview:"탐지된 얼굴",shareCardTitle:"나의 나는솔로 이름은",shareCardBadge:"오락용 아키타입 분류 · 실존 인물 식별 아님"},en:{title:"If you joined I AM SOLO, what would your name be?",subtitle:"Check your Top 3 name results.",retry:"Try Again",empty:"No result found. Please run analysis again.",uncertain:"The top matches are very close. Try again with a clearer front-face photo.",confidenceHigh:"Match confidence: High",confidenceMid:"Match confidence: Medium",confidenceLow:"Match confidence: Low",retryGuide:"Retry with a front-facing, well-lit, single-face photo for better accuracy.",topHint:"Closest type based on visual impression keywords.",shareSocial:"Share with friends",shareImage:"Save Image",shareLink:"Copy Link",copied:"Copied!",copiedDesc:"Paste the link to share with friends.",shareOpened:"Share sheet opened",copyFallback:"Clipboard blocked. Opened manual copy prompt.",topPick:"Today's signature type",facePreview:"Detected face",shareCardTitle:"My I AM SOLO name is",shareCardBadge:"Entertainment archetype only · not identity recognition"},ja:{title:"나는 솔로 に出たら、私の名前は？",subtitle:"Top 3 名前の結果を確認してください。",retry:"もう一度分析",empty:"結果がありません。もう一度分析してください。",uncertain:"上位候補が近すぎます。正面で鮮明な顔写真で再試行してください。",confidenceHigh:"マッチ信頼度: 高い",confidenceMid:"マッチ信頼度: 普通",confidenceLow:"マッチ信頼度: 低い",retryGuide:"正面・明るい環境・単独の顔写真で再試行すると精度が上がります。",topHint:"印象キーワードベースで最も近いタイプです。",shareSocial:"友だちに共有",shareImage:"画像を保存",shareLink:"リンクをコピー",copied:"コピー完了!",copiedDesc:"リンクを貼り付けて友だちに共有できます。",shareOpened:"共有シートを開きました",copyFallback:"クリップボードが使えないため手動コピー画面を開きました。",topPick:"今日のシグネチャータイプ",facePreview:"検出された顔",shareCardTitle:"私の I AM SOLO 名前は",shareCardBadge:"エンタメ用アーキタイプ分類 · 実在人物識別ではありません"}},a=O[C]||O.ko,H=document.querySelector(".hero h1"),q=document.querySelector(".hero p"),v=document.querySelector("a.btn.ghost[href^='/scan.html']"),w=document.querySelector("#toast");H&&(H.textContent=a.title);q&&(q.textContent=a.subtitle);p&&(p.textContent=a.shareSocial);u&&(u.textContent=a.shareImage);h&&(h.textContent=a.shareLink);v&&(v.textContent=a.retry,v.href=`/scan.html?lang=${encodeURIComponent(C)}`);function S(n,t=""){w&&(w.innerHTML=`<strong>${n}</strong>${t?`<span>${t}</span>`:""}`,w.classList.add("show"),setTimeout(()=>w.classList.remove("show"),1600))}async function W(n){try{return await navigator.clipboard.writeText(n),!0}catch{}try{const t=document.createElement("textarea");t.value=n,t.style.position="fixed",t.style.opacity="0",t.style.left="-9999px",document.body.appendChild(t),t.focus(),t.select();const e=document.execCommand("copy");return document.body.removeChild(t),e}catch{return!1}}function X(n,t){const e={rows:n.map(d=>({slug:d.slug,p:d.p})),face:void 0};return btoa(unescape(encodeURIComponent(JSON.stringify(e))))}function Y(n){if(!n)return null;try{return JSON.parse(decodeURIComponent(escape(atob(n))))}catch{return null}}async function B(n){const t=new URL(location.href);return t.searchParams.set("lang",C),t.searchParams.set("r",X(n)),`${t.origin}${t.pathname}?${t.searchParams.toString()}`}async function A(n){const t=document.createElement("canvas");t.width=1080,t.height=1350;const e=t.getContext("2d"),d=e.createLinearGradient(0,0,1080,1350);d.addColorStop(0,"#101827"),d.addColorStop(.5,"#1e1b4b"),d.addColorStop(1,"#312e81"),e.fillStyle=d,e.fillRect(0,0,t.width,t.height),e.fillStyle="rgba(255,255,255,0.12)",e.beginPath(),e.arc(900,180,220,0,Math.PI*2),e.fill(),e.beginPath(),e.arc(200,1160,280,0,Math.PI*2),e.fill(),e.fillStyle="#dbeafe",e.font="700 30px system-ui",e.fillText("AI FACE MATCH",80,84),e.fillStyle="#ffffff",e.font="800 64px system-ui",e.fillText(a.shareCardTitle,80,156);const k=n[0];if(e.fillStyle="#a5b4fc",e.font="700 44px system-ui",e.fillText(`${k?.label??"-"} 타입`,80,214),m){const s=m;try{const c=await new Promise((D,N)=>{const g=new Image;g.onload=()=>D(g),g.onerror=N,g.src=s}),r=280,o=280,f=80,l=250,y=Math.max(r/c.width,o/c.height),$=c.width*y,L=c.height*y,F=f+(r-$)/2,j=l+(o-L)/2;e.save(),e.beginPath(),e.roundRect(f,l,r,o,28),e.clip(),e.drawImage(c,F,j,$,L),e.restore(),e.strokeStyle="rgba(255,255,255,0.6)",e.lineWidth=3,e.strokeRect(f,l,r,o)}catch{}}return n.forEach((s,c)=>{const r=860+c*140,o=Math.round(s.p*10)/10;e.fillStyle="#ffffff",e.font=c===0?"800 46px system-ui":"700 38px system-ui",e.fillText(`${c+1}. ${s.label}`,90,r),e.fillStyle="#c7d2fe",e.font="700 30px system-ui",e.fillText(`${o}%`,420,r),e.fillStyle="rgba(255,255,255,0.18)",e.fillRect(520,r-30,460,20),e.fillStyle=c===0?"#fbbf24":"#93c5fd",e.fillRect(520,r-30,Math.max(14,Math.min(460,o*4.6)),20),e.fillStyle="#dbeafe",e.font="500 24px system-ui",e.fillText(s.desc,90,r+38)}),e.fillStyle="rgba(255,255,255,0.72)",e.font="500 23px system-ui",e.fillText(a.shareCardBadge,80,1294),t}const x=Y(E.get("r"));let i=null;if(U)i=JSON.parse(U);else if(x?.rows){const n=new Map(_.map(t=>[t.slug,t]));i=x.rows.map(t=>{const e=n.get(t.slug);return e?{...e,p:t.p}:null}).filter(Boolean)}x?.face&&!m&&(m=x.face);if(!i?.length)T.innerHTML=`<p>${a.empty}</p><div class="card"><a class="btn" href="/scan.html">나도 해보기</a></div>`,p&&(p.style.display="none"),u&&(u.style.display="none"),h&&(h.style.display="none");else{const n=(i[0]?.p??0)-(i[1]?.p??0),t=n>=14?a.confidenceHigh:n>=8?a.confidenceMid:a.confidenceLow,e=n>=14?"confidence-high":n>=8?"confidence-mid":"confidence-low",d=n<8?`<div class="card"><p class="muted">${a.uncertain}</p><small class="muted">${a.retryGuide}</small></div>`:"",k=m?`<div class="card"><small class="muted">${a.facePreview}</small><div style="margin-top:8px"><img src="${m}" alt="detected face" style="width:100%;max-width:220px;border-radius:16px;border:1px solid #dbe5f3;display:block"/></div></div>`:"";T.innerHTML=`<div class="card confidence-card ${e}"><small class="kicker">${a.topPick}</small><br/><strong>${t}</strong><br/><small class="muted">${a.topHint}</small></div>`+d+k+i.map((s,c)=>{const r=Number.isFinite(s.p)?s.p:0,o=Math.max(0,Math.min(100,Math.round(r*10)/10));return`
    <div class="card result-card ${c===0?"top-card":""}">
      <small class="muted">${c+1}순위</small>
      <div class="result-top">${s.label} <span class="muted" style="font-size:22px">${o}%</span></div>
      <p>${s.desc}</p>
      <div class="bar"><i style="width:${o}%"></i></div>
    </div>`}).join(""),p&&(p.onclick=()=>{J?.classList.toggle("show")}),(async()=>{const s=await B(i),c=encodeURIComponent(`${a.title} - ${i?.[0]?.label??""}`),r=encodeURIComponent(s);b&&(b.href=`https://story.kakao.com/share?url=${r}`,b.onclick=async o=>{o.preventDefault();try{if(navigator.share){await navigator.share({title:a.title,text:i?.[0]?.label,url:s}),S("카카오톡 공유","대화창 대상 선택에서 카카오톡을 선택하세요.");return}}catch{}window.open(b.href,"_blank","noopener")}),M&&(M.href=`https://twitter.com/intent/tweet?text=${c}&url=${r}`),P&&(P.href=`https://t.me/share/url?url=${r}&text=${c}`),I&&(I.href=`https://www.facebook.com/sharer/sharer.php?u=${r}`),R&&(R.onclick=async()=>{const o=await A(i),f=await new Promise(y=>o.toBlob(y,"image/png"));if(!f)return;const l=document.createElement("a");l.href=URL.createObjectURL(f),l.download="nsolo-result.png",document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(l.href),S(a.shareImage,"저장 후 인스타에서 업로드해 주세요.")})})(),u&&(u.onclick=async()=>{const s=await A(i),c=await new Promise(o=>s.toBlob(o,"image/png"));if(!c)return;const r=new File([c],"nsolo-result.png",{type:"image/png"});try{if(navigator.share&&navigator.canShare?.({files:[r]}))await navigator.share({files:[r],title:"나는솔로 테스트 결과"});else{const o=document.createElement("a");o.href=URL.createObjectURL(c),o.download="nsolo-result.png",document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(o.href)}}catch{}}),h&&(h.onclick=async()=>{const s=await B(i);await W(s)?(h.textContent=a.copied,S(a.copied,a.copiedDesc),setTimeout(()=>{h&&(h.textContent=a.shareLink)},1200)):(window.prompt("링크를 복사해 공유하세요",s),S(a.copyFallback))})}G();
