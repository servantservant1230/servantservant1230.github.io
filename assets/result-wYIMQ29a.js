import"./styles-Cm1FHhnm.js";import{i as $}from"./ads-D-IuExRI.js";import{N as M}from"./types-CWP0aW2C.js";const h=document.querySelector("#result"),y=document.querySelector("#share-image"),d=document.querySelector("#share-link"),g=sessionStorage.getItem("nsolo_result"),u=sessionStorage.getItem("nsolo_face"),v=new URLSearchParams(location.search),p=v.get("lang")||"ko",w={ko:{title:"나는 솔로에 나간다면 나의 이름은?",subtitle:"Top 3 이름 결과를 확인해보세요.",retry:"다시 분석",empty:"결과가 없습니다. 다시 분석해주세요.",uncertain:"유사한 타입이 겹쳐 보여요. 더 정면/근거리 얼굴 사진으로 다시 시도해보세요.",confidenceHigh:"매칭 신뢰도 높음",confidenceMid:"매칭 신뢰도 보통",confidenceLow:"매칭 신뢰도 낮음",retryGuide:"정면/밝은 조명/단독 얼굴로 다시 촬영하면 정확도가 올라갑니다.",topHint:"인상 키워드 기반으로 가장 가까운 타입입니다."},en:{title:"If you joined I AM SOLO, what would your name be?",subtitle:"Check your Top 3 name results.",retry:"Try Again",empty:"No result found. Please run analysis again.",uncertain:"The top matches are very close. Try again with a clearer front-face photo.",confidenceHigh:"Match confidence: High",confidenceMid:"Match confidence: Medium",confidenceLow:"Match confidence: Low",retryGuide:"Retry with a front-facing, well-lit, single-face photo for better accuracy.",topHint:"Closest type based on visual impression keywords."},ja:{title:"나는 솔로 に出たら、私の名前は？",subtitle:"Top 3 名前の結果を確認してください。",retry:"もう一度分析",empty:"結果がありません。もう一度分析してください。",uncertain:"上位候補が近すぎます。正面で鮮明な顔写真で再試行してください。",confidenceHigh:"マッチ信頼度: 高い",confidenceMid:"マッチ信頼度: 普通",confidenceLow:"マッチ信頼度: 低い",retryGuide:"正面・明るい環境・単独の顔写真で再試行すると精度が上がります。",topHint:"印象キーワードベースで最も近いタイプです。"}},c=w[p]||w.ko,b=document.querySelector(".hero h1"),S=document.querySelector(".hero p"),m=document.querySelector(".row .btn.ghost");b&&(b.textContent=c.title);S&&(S.textContent=c.subtitle);m&&(m.textContent=c.retry,m.href=`/scan.html?lang=${encodeURIComponent(p)}`);function R(a){return btoa(unescape(encodeURIComponent(JSON.stringify(a.map(n=>({slug:n.slug,p:n.p}))))))}function T(a){if(!a)return null;try{return JSON.parse(decodeURIComponent(escape(atob(a))))}catch{return null}}async function C(a){const n=document.createElement("canvas");n.width=1080,n.height=1350;const e=n.getContext("2d");if(e.fillStyle="#0f172a",e.fillRect(0,0,n.width,n.height),e.fillStyle="#ffffff",e.font="bold 56px system-ui",e.fillText("나는솔로 타입 결과",80,120),u)try{const r=await new Promise((l,t)=>{const o=new Image;o.onload=()=>l(o),o.onerror=t,o.src=u});e.save(),e.beginPath(),e.roundRect(80,170,240,240,24),e.clip(),e.drawImage(r,80,170,240,240),e.restore(),e.strokeStyle="#334155",e.lineWidth=2,e.strokeRect(80,170,240,240)}catch{}return e.fillStyle="#ffffff",e.font="42px system-ui",a.forEach((r,l)=>{const t=500+l*180,o=Math.round(r.p*10)/10;e.fillText(`${l+1}. ${r.label}  ${o}%`,80,t),e.font="30px system-ui",e.fillStyle="#cbd5e1",e.fillText(r.desc,120,t+48),e.fillStyle="#60a5fa",e.fillRect(120,t+70,Math.max(8,Math.min(760,o*7.6)),12),e.font="42px system-ui",e.fillStyle="#ffffff"}),e.fillStyle="#94a3b8",e.font="26px system-ui",e.fillText("오락용 아키타입 분류 · 실존 인물 식별 아님",80,1280),n}const x=T(v.get("r"));let s=null;if(g)s=JSON.parse(g);else if(x){const a=new Map(M.map(n=>[n.slug,n]));s=x.map(n=>{const e=a.get(n.slug);return e?{...e,p:n.p}:null}).filter(Boolean)}if(!s?.length)h.innerHTML=`<p>${c.empty}</p>`;else{const a=(s[0]?.p??0)-(s[1]?.p??0),n=a>=14?c.confidenceHigh:a>=8?c.confidenceMid:c.confidenceLow,e=a>=14?"confidence-high":a>=8?"confidence-mid":"confidence-low",r=a<8?`<div class="card"><p class="muted">${c.uncertain}</p><small class="muted">${c.retryGuide}</small></div>`:"",l=u?`<div class="card"><small class="muted">탐지된 얼굴</small><div style="margin-top:8px"><img src="${u}" alt="detected face" style="width:100%;max-width:220px;border-radius:16px;border:1px solid #dbe5f3;display:block"/></div></div>`:"";h.innerHTML=`<div class="card confidence-card ${e}"><strong>${n}</strong><br/><small class="muted">${c.topHint}</small></div>`+r+l+s.map((t,o)=>{const f=Number.isFinite(t.p)?t.p:0,i=Math.max(0,Math.min(100,Math.round(f*10)/10));return`
    <div class="card result-card ${o===0?"top-card":""}">
      <small class="muted">${o+1}순위</small>
      <div class="result-top">${t.label} <span class="muted" style="font-size:22px">${i}%</span></div>
      <p>${t.desc}</p>
      <div class="bar"><i style="width:${i}%"></i></div>
    </div>`}).join(""),y&&(y.onclick=async()=>{const t=await C(s),o=await new Promise(i=>t.toBlob(i,"image/png"));if(!o)return;const f=new File([o],"nsolo-result.png",{type:"image/png"});try{if(navigator.share&&navigator.canShare?.({files:[f]}))await navigator.share({files:[f],title:"나는솔로 테스트 결과"});else{const i=document.createElement("a");i.href=URL.createObjectURL(o),i.download="nsolo-result.png",document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(i.href)}}catch{}}),d&&(d.onclick=async()=>{const t=new URL(location.href);t.searchParams.set("lang",p),t.searchParams.set("r",R(s));const o=`${t.origin}${t.pathname}?${t.searchParams.toString()}`;await navigator.clipboard.writeText(o),d.textContent="복사됨!",setTimeout(()=>{d&&(d.textContent="결과 링크 복사")},1200)})}$();
